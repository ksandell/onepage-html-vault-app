<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vault Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 10px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 100%;
            max-width: 700px;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 14px;
        }

        .content {
            padding: 30px;
        }

        .section {
            margin-bottom: 25px;
        }

        .section h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 18px;
            border-bottom: 2px solid #667eea;
            padding-bottom: 5px;
        }

        .input-group {
            margin-bottom: 15px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            color: #555;
            font-size: 14px;
            font-weight: 500;
        }

        .input-group input[type="text"],
        .input-group input[type="password"],
        .input-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .input-group textarea {
            resize: vertical;
            min-height: 80px;
            font-family: inherit;
        }

        .input-group input:focus,
        .input-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .file-input {
            width: 100%;
            padding: 10px;
            border: 2px dashed #667eea;
            border-radius: 8px;
            background: #f8f9fa;
            cursor: pointer;
            transition: background 0.3s;
        }

        .file-input:hover {
            background: #e9ecef;
        }

        .file-list {
            margin-top: 15px;
            max-height: 200px;
            overflow-y: auto;
        }

        .file-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 12px;
            background: #f8f9fa;
            border-radius: 6px;
            margin-bottom: 8px;
        }

        .file-name {
            flex: 1;
            font-size: 14px;
            color: #333;
        }

        .file-size {
            color: #666;
            font-size: 12px;
            margin-left: 10px;
        }

        .file-remove {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }

        .file-remove:hover {
            background: #c82333;
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 14px 30px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }

        .key-display {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            display: none;
        }

        .key-display h4 {
            margin-bottom: 10px;
            color: #333;
        }

        .key-display .key-value {
            font-family: monospace;
            background: white;
            padding: 8px;
            border-radius: 4px;
            margin-bottom: 8px;
            word-break: break-all;
        }

        .progress {
            display: none;
            text-align: center;
            color: #666;
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>üîê Vault Generator</h1>
            <p>Create secure encrypted storage vaults</p>
        </div>

        <div class="content">
            <div class="section">
                <h3>1. Vault Information</h3>
                <div class="input-group">
                    <label>Vault Name</label>
                    <input type="text" id="vaultName" placeholder="Enter vault name (e.g., 'Q4 Financial Reports')">
                </div>
                <div class="input-group">
                    <label>Vault Description</label>
                    <textarea id="description"
                        placeholder="Enter a description for this vault (e.g., 'Company confidential documents requiring dual authorization')"></textarea>
                </div>
            </div>

            <div class="section">
                <h3>2. Add Files</h3>
                <div class="input-group">
                    <input type="file" id="fileInput" class="file-input" multiple accept="*">
                    <div class="file-list" id="fileList"></div>
                </div>
            </div>

            <div class="section">
                <h3>3. Set Access Keys</h3>
                <div class="input-group">
                    <label>Key A (Give to first person)</label>
                    <input type="password" id="keyA" placeholder="Enter first key">
                </div>
                <div class="input-group">
                    <label>Key B (Give to second person)</label>
                    <input type="password" id="keyB" placeholder="Enter second key">
                </div>
            </div>

            <button class="btn" id="generateBtn" onclick="generateVault()">Generate Vault</button>

            <div class="progress" id="progress">
                <p>üîÑ Generating your vault...</p>
            </div>

            <div class="success" id="success">
                <h4>‚úÖ Vault Generated Successfully!</h4>
                <p>Your vault has been created and downloaded.</p>
                <div class="key-display" id="keyDisplay">
                    <h4>üîë Access Keys (Keep these safe!):</h4>
                    <div class="key-value">Key A: <strong id="showKeyA"></strong></div>
                    <div class="key-value">Key B: <strong id="showKeyB"></strong></div>
                    <p style="margin-top: 10px; font-size: 14px; color: #666;">
                        Both keys are required to unlock the vault. Store them separately for maximum security.
                    </p>
                </div>
            </div>

            <div class="error" id="error"></div>
        </div>
    </div>
    <script>
        let selectedFiles = [];

        // File input handling
        document.getElementById('fileInput').addEventListener('change', function (e) {
            handleFiles(e.target.files);
        });

        function handleFiles(files) {
            for (let file of files) {
                const reader = new FileReader();
                reader.onload = function (e) {
                    selectedFiles.push({
                        name: file.name,
                        type: file.type || 'application/octet-stream',
                        size: formatFileSize(file.size),
                        data: e.target.result.split(',')[1] // Base64 data
                    });
                    updateFileList();
                };
                reader.readAsDataURL(file);
            }
        }

        function updateFileList() {
            const fileList = document.getElementById('fileList');
            fileList.innerHTML = '';

            selectedFiles.forEach((file, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                fileItem.innerHTML = `
                    <span class="file-name">${file.name}</span>
                    <span class="file-size">${file.size}</span>
                    <button class="file-remove" onclick="removeFile(${index})">Remove</button>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        async function generateVault() {
            // Reset messages
            document.getElementById('error').style.display = 'none';
            document.getElementById('success').style.display = 'none';

            // Get inputs
            const vaultName = document.getElementById('vaultName').value.trim();
            const description = document.getElementById('description').value.trim();
            const keyA = document.getElementById('keyA').value;
            const keyB = document.getElementById('keyB').value;

            // Validation
            if (!vaultName) {
                showError('Please enter a vault name');
                return;
            }

            if (!description) {
                showError('Please enter a vault description');
                return;
            }

            if (selectedFiles.length === 0) {
                showError('Please add at least one file to the vault');
                return;
            }

            if (!keyA || !keyB) {
                showError('Please enter both Key A and Key B');
                return;
            }

            if (keyA.length < 4 || keyB.length < 4) {
                showError('Keys must be at least 4 characters long');
                return;
            }

            // Show progress
            document.getElementById('progress').style.display = 'block';
            document.getElementById('generateBtn').disabled = true;

            // Generate vault HTML
            const vaultHTML = generateVaultHTML(vaultName, description, selectedFiles, keyA, keyB);

            // Download the file using data URL
            const dataUrl = 'data:text/html;charset=utf-8,' + encodeURIComponent(vaultHTML);
            const a = document.createElement('a');
            a.href = dataUrl;
            a.download = `${vaultName.replace(/[^a-z0-9]/gi, '_').toLowerCase()}_vault.html`;
            a.click();

            // Show success message
            document.getElementById('progress').style.display = 'none';
            document.getElementById('success').style.display = 'block';
            document.getElementById('keyDisplay').style.display = 'block';
            document.getElementById('showKeyA').textContent = keyA;
            document.getElementById('showKeyB').textContent = keyB;

            // Reset form
            document.getElementById('generateBtn').disabled = false;
        }

        function showError(message) {
            const errorEl = document.getElementById('error');
            errorEl.textContent = message;
            errorEl.style.display = 'block';
        }

        function generateVaultHTML(vaultName, description, files, keyA, keyB) {
            const createdDate = new Date().toLocaleString();
            const filesData = JSON.stringify(files);

            var html = `<!DOCTYPE html>
    <html lang="en">
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>${vaultName} - Secure Vault</title>
        <style>
        *{margin:0;padding:0;box-sizing:border-box;}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:20px;}
        .container{background:white;border-radius:10px;box-shadow:0 20px 60px rgba(0,0,0,0.3);width:100%;max-width:600px;overflow:hidden;}
        .header{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;padding:30px;text-align:center;}
        .header h1{font-size:24px;margin-bottom:10px;}
        .header p{opacity:0.9;font-size:14px;}
        .content{padding:30px;}
        .unlock-form{display:flex;flex-direction:column;gap:20px;}
        .input-group{position:relative;}
        .input-group input{width:100%;padding:12px 40px 12px 15px;border:2px solid #e0e0e0;border-radius:8px;font-size:16px;transition:border-color 0.3s;}
        .input-group input:focus{outline:none;border-color:#667eea;}
        .input-group .toggle-password{position:absolute;right:12px;top:50%;transform:translateY(-50%);background:none;border:none;cursor:pointer;color:#666;font-size:20px;}
        .btn{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%);color:white;border:none;padding:12px 30px;border-radius:8px;font-size:16px;cursor:pointer;transition:transform 0.2s,box-shadow 0.2s;}
        .btn:hover{transform:translateY(-2px);box-shadow:0 5px 20px rgba(102,126,234,0.4);}
        .btn:active{transform:translateY(0);}
        .file-list{display:none;}
        .file-list h2{margin-bottom:20px;color:#333;}
        .file-item{background:#f8f9fa;border-radius:8px;padding:15px;margin-bottom:10px;display:flex;justify-content:space-between;align-items:center;transition:background 0.2s;}
        .file-item:hover{background:#e9ecef;}
        .file-info{flex:1;}
        .file-name{font-weight:500;color:#333;margin-bottom:5px;}
        .file-meta{font-size:12px;color:#666;}
        .file-actions{display:flex;gap:10px;}
        .file-btn{padding:8px 16px;background:#667eea;color:white;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:background 0.2s;}
        .file-btn:hover{background:#5567d8;}
        .file-btn.download{background:#28a745;}
        .file-btn.download:hover{background:#218838;}
        .error{background:#f8d7da;color:#721c24;padding:12px;border-radius:6px;margin-top:15px;display:none;}
        .lock-btn{margin-top:20px;background:#dc3545;}
        .lock-btn:hover{background:#c82333;}
        .loading{display:none;text-align:center;color:#666;margin:20px 0;}
        </style>
    </head>
    <body>
        <div class="container">
            <div class="header">
                <h1>üîê Vault</h1>
                <p>Secure encrypted storage</p>
            </div>
            <div class="content">
                <div class="unlock-form" id="unlockForm">
                    <div style="background: #f8f9fa; border-radius: 8px; padding: 15px; margin-bottom: 20px;">
                        <div style="color: #333; font-size: 18px; font-weight: 600; margin-bottom: 10px;">
                            ${vaultName}
                        </div>
                        <div style="color: #555; font-size: 14px; line-height: 1.5;">
                            ${description}
                        </div>
                        <div style="margin-top: 10px; padding-top: 10px; border-top: 1px solid #dee2e6;">
                            <div style="color: #6c757d; font-size: 12px;">
                                Created: <span id="vaultCreated">${createdDate}</span>
                            </div>
                        </div>
                    </div>
                    <div style="margin-bottom: 15px; color: #666; font-size: 14px; text-align: center;">
                        üîë Two keys are required to unlock this vault
                    </div>
                    <div class="input-group">
                        <input type="password" id="keyA" placeholder="Enter Key A" autofocus>
                    </div>
                    <div class="input-group">
                        <input type="password" id="keyB" placeholder="Enter Key B">
                    </div>
                    <button class="btn" onclick="unlock()">Unlock Vault</button>
                    <div class="error" id="error"></div>
                </div>
                <div class="loading" id="loading">Decrypting...</div>
                <div class="file-list" id="fileList">
                    <h2>üìÅ Vault Contents</h2>
                    <div id="filesContainer"></div>
                    <button class="btn lock-btn" onclick="lock()">üîí Lock Vault</button>
                </div>
            </div>
        </div>`;

            html += `
        <script>
            const VAULT_INFO = {
                name: "${vaultName}",
                created: "${createdDate}",
                description: "${description}"
            };
            const ENCRYPTED_VAULT = {
                keyA: "${keyA}",
                keyB: "${keyB}",
                data: ${filesData}
            };
            let decryptedData = null;

            function togglePassword(inputId) {
                const input = document.getElementById(inputId);
                input.type = input.type === 'password' ? 'text' : 'password';
            }

            function unlock() {
                const keyA = document.getElementById('keyA').value;
                const keyB = document.getElementById('keyB').value;
                if (!keyA || !keyB) {
                    showError('Please enter both Key A and Key B');
                    return;
                }
                document.getElementById('loading').style.display = 'block';
                document.getElementById('error').style.display = 'none';
                setTimeout(() => {
                    if (keyA === ENCRYPTED_VAULT.keyA && keyB === ENCRYPTED_VAULT.keyB) {
                        decryptedData = ENCRYPTED_VAULT.data;
                        displayFiles();
                        document.getElementById('unlockForm').style.display = 'none';
                        document.getElementById('fileList').style.display = 'block';
                    } else {
                        showError('Incorrect key combination');
                    }
                    document.getElementById('loading').style.display = 'none';
                }, 500);
            }

            function lock() {
                decryptedData = null;
                document.getElementById('keyA').value = '';
                document.getElementById('keyB').value = '';
                document.getElementById('unlockForm').style.display = 'flex';
                document.getElementById('fileList').style.display = 'none';
                document.getElementById('error').style.display = 'none';
            }

            function displayFiles() {
                const container = document.getElementById('filesContainer');
                container.innerHTML = '';
                if (!decryptedData || decryptedData.length === 0) {
                    container.innerHTML = '<p>No files found</p>';
                    console.log('No files to display');
                    return;
                }
                decryptedData.forEach((file, index) => {
                    console.log('Showing file : ', file.name);
                    const fileElement = document.createElement('div');
                    fileElement.className = 'file-item';
                    fileElement.innerHTML = \`
                        <div class="file-info">
                            <div class="file-name">\${file.name}</div>
                            <div class="file-meta">\${file.type} ‚Ä¢ \${file.size}</div>
                        </div>
                        <div class="file-actions">
                            <button class="file-btn" onclick="viewFile(\${index})">View</button>
                            <button class="file-btn download" onclick="downloadFile(\${index})">Download</button>
                        </div>
                    \`;
                    container.appendChild(fileElement);
                });
            }

            function viewFile(index) {
                const file = decryptedData[index];

                const modal = document.createElement('div');
                modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.8);display:flex;justify-content:center;align-items:center;z-index:1000;';

                const container = document.createElement('div');
                container.style.cssText = 'background:white;border-radius:8px;max-width:80%;width:900px;height:80%;max-height:90vh;display:flex;flex-direction:column;overflow:hidden;box-shadow:0 20px 60px rgba(0,0,0,0.5);';

                // Helper function to check if file is text-based
                const isTextFile = (file) => {
                    const textTypes = [
                        'text/',
                        'application/json',
                        'application/xml',
                        'application/yaml',
                        'application/x-yaml',
                        'application/javascript',
                        'application/typescript'
                    ];
                    const textExtensions = ['.txt', '.md', '.json', '.yaml', '.yml', '.xml', '.js', '.ts', '.jsx', '.tsx', '.css', '.html', '.htm', '.csv', '.log', '.sh', '.bat', '.ps1', '.sql', '.py', '.java', '.c', '.cpp', '.h', '.hpp', '.go', '.rs', '.php', '.rb', '.swift', '.kt', '.scala', '.r', '.m', '.pl', '.lua'];

                    return textTypes.some(type => file.type.includes(type)) ||
                        textExtensions.some(ext => file.name.toLowerCase().endsWith(ext)) ||
                        file.type === 'application/octet-stream' && textExtensions.some(ext => file.name.toLowerCase().endsWith(ext));
                };

                const header = document.createElement('div');
                header.style.cssText = \`
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 15px 20px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    flex-shrink: 0;
                \`;
                const fileInfo = document.createElement('div');
                fileInfo.innerHTML = \`
                    <div style="font-weight: 600; font-size: 16px;">\${file.name}</div>
                    <div style="font-size: 12px; opacity: 0.9; margin-top: 4px;">\${file.type} ‚Ä¢ \${file.size}</div>
                \`;
                const headerButtons = document.createElement('div');
                headerButtons.style.cssText = 'display: flex; gap: 10px;';

                if (file.type.startsWith('image/') || file.type === 'application/pdf') {
                    const newTabBtn = document.createElement('button');
                    newTabBtn.textContent = 'üîó Open in New Tab';
                    newTabBtn.style.cssText = \`
                        background: rgba(255,255,255,0.2);
                        color: white;
                        border: 1px solid rgba(255,255,255,0.3);
                        padding: 6px 12px;
                        border-radius: 4px;
                        cursor: pointer;
                        font-size: 14px;
                    \`;
                    newTabBtn.onmouseover = () => newTabBtn.style.background = 'rgba(255,255,255,0.3)';
                    newTabBtn.onmouseout = () => newTabBtn.style.background = 'rgba(255,255,255,0.2)';
                    newTabBtn.onclick = () => {
                        const newWindow = window.open('', '_blank');
                        if (file.type === 'application/pdf') {
                            newWindow.document.write(\`
                                <html>
                                <head><title>\${file.name}</title></head>
                                <body style="margin:0;">
                                    <embed src="data:\${file.type};base64,\${file.data}"
                                        width="100%" height="100%" type="application/pdf">
                                </body>
                                </html>
                            \`);
                        } else {
                            newWindow.document.write(\`
                                <html>
                                <head><title>\${file.name}</title></head>
                                <body style="margin:0; display:flex; justify-content:center; align-items:center; min-height:100vh; background:#222;">
                                    <img src="data:\${file.type};base64,\${file.data}" style="max-width:100%; max-height:100vh;">
                                </body>
                                </html>
                            \`);
                        }
                    };
                    headerButtons.appendChild(newTabBtn);
                }

                if (isTextFile(file)) {
                    const decodedData = atob(file.data);
                    const copyBtn = document.createElement('button');
                    copyBtn.textContent = 'üìã Copy';
                    copyBtn.style.cssText = \`
                        background: rgba(255,255,255,0.2);
                        color: white;
                        border: 1px solid rgba(255,255,255,0.3);
                        padding: 6px 12px;
                        border-radius: 4px;
                        cursor: pointer;
                        font-size: 14px;
                    \`;
                    copyBtn.onmouseover = () => copyBtn.style.background = 'rgba(255,255,255,0.3)';
                    copyBtn.onmouseout = () => copyBtn.style.background = 'rgba(255,255,255,0.2)';
                    copyBtn.onclick = () => {
                        navigator.clipboard.writeText(decodedData);
                        copyBtn.textContent = '‚úì Copied!';
                        setTimeout(() => copyBtn.textContent = 'üìã Copy', 2000);
                    };
                    headerButtons.appendChild(copyBtn);
                }

                const downloadBtn = document.createElement('button');
                downloadBtn.textContent = '‚¨á Download';
                downloadBtn.style.cssText = \`
                    background: rgba(255,255,255,0.2);
                    color: white;
                    border: 1px solid rgba(255,255,255,0.3);
                    padding: 6px 12px;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 14px;
                \`;
                downloadBtn.onmouseover = () => downloadBtn.style.background = 'rgba(255,255,255,0.3)';
                downloadBtn.onmouseout = () => downloadBtn.style.background = 'rgba(255,255,255,0.2)';
                downloadBtn.onclick = () => downloadFile(index);
                headerButtons.appendChild(downloadBtn);
                header.appendChild(fileInfo);
                header.appendChild(headerButtons);

                const content = document.createElement('div');
                content.style.cssText = \`
                    flex: 1;
                    overflow: auto;
                    padding: 20px;
                    background: #f8f9fa;
                \`;

                if (isTextFile(file)) {
                    const decodedData = atob(file.data);
                    const pre = document.createElement('pre');
                    pre.style.cssText = \`
                        margin: 0;
                        font-family: 'Courier New', monospace;
                        white-space: pre-wrap;
                        word-wrap: break-word;
                        background: white;
                        padding: 20px;
                        border-radius: 6px;
                        line-height: 1.5;
                    \`;
                    pre.textContent = decodedData;
                    content.appendChild(pre);
                } else if (file.type.startsWith('image/')) {
                    content.style.cssText += 'display: flex; justify-content: center; align-items: center;';
                    const img = document.createElement('img');
                    img.src = \`data:\${file.type};base64,\${file.data}\`;
                    img.style.cssText = 'max-width: 100%; max-height: 100%; object-fit: contain;';
                    content.appendChild(img);
                } else if (file.type === 'application/pdf') {
                    content.style.cssText += 'padding: 0;';
                    const embed = document.createElement('embed');
                    embed.src = \`data:\${file.type};base64,\${file.data}\`;
                    embed.type = 'application/pdf';
                    embed.style.cssText = 'width: 100%; height: 100%;';
                    content.appendChild(embed);
                } else {
                    content.innerHTML = \`
                        <div style="text-align: center; padding: 40px;">
                            <div style="font-size: 48px; margin-bottom: 20px;">üìÑ</div>
                            <p>Preview not available for this file type</p>
                            <p style="color: #666; margin-top: 10px;">Click Download to save this file</p>
                        </div>
                    \`;
                }

                const footer = document.createElement('div');
                footer.style.cssText = \`
                    background: white;
                    padding: 15px 20px;
                    border-top: 1px solid #e0e0e0;
                    display: flex;
                    justify-content: center;
                    flex-shrink: 0;
                \`;
                const closeBtn = document.createElement('button');
                closeBtn.textContent = 'Close';
                closeBtn.style.cssText = \`
                    background: #6c757d;
                    color: white;
                    border: none;
                    padding: 10px 30px;
                    border-radius: 6px;
                    cursor: pointer;
                    font-size: 16px;
                \`;
                closeBtn.onmouseover = () => closeBtn.style.background = '#5a6268';
                closeBtn.onmouseout = () => closeBtn.style.background = '#6c757d';
                closeBtn.onclick = () => modal.remove();
                footer.appendChild(closeBtn);
                container.appendChild(header);
                container.appendChild(content);
                container.appendChild(footer);
                modal.appendChild(container);
                document.body.appendChild(modal);
                modal.onclick = (e) => {
                    if (e.target === modal) modal.remove();
                };
                const escHandler = (e) => {
                    if (e.key === 'Escape') {
                        modal.remove();
                        document.removeEventListener('keydown', escHandler);
                    }
                };
                document.addEventListener('keydown', escHandler);
            }

            function downloadFile(index) {
                const file = decryptedData[index];
                const link = document.createElement('a');
                link.href = \`data:\${file.type};base64,\${file.data}\`;
                link.download = file.name;
                link.click();
            }

            function showError(message) {
                const errorElement = document.getElementById('error');
                errorElement.textContent = message;
                errorElement.style.display = 'block';
            }
            document.getElementById('keyA').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    document.getElementById('keyB').focus();
                }
            });
            document.getElementById('keyB').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    unlock();
                }
            });
            </sc ript>
        </body>
    </html>`;

            // Replace "</sc ript>" with same without space in middle
            html = html.replace(/\/sc ript/g, '/script');

            return html;
        } // end of function

    </script>
</body>

</html>